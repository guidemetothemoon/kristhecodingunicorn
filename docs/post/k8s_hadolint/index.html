<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme="dark"
  
    class="html theme--dark"
  
><head>
  <title>
    Kris - The Coding Unicorn
        |
        Applying Dockerfile best practices with Hadolint
      

    

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.111.3"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Kris - The Coding Unicorn" />
  <meta
    name="description"
    content="In this blog post we&#39;ll look into how we can ensure that Dockerfiles we create are following best practices with Hadolint tool."
  />
  
    <meta name="google-site-verification" content="OQXmc6vSYyn6I-aGZoI6GH2M6CdM4NjmwulDqvvNCQA" />
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.5794be192d21535bdd301561e043a96b6adbad2b5c08279deff459e4661c613f.css"
      integrity="sha256-V5S&#43;GS0hU1vdMBVh4EOpa2rbrStcCCed7/RZ5GYcYT8="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css"
    integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU="
    crossorigin="anonymous"
    type="text/css"
  />
  
    
    
    <link
      rel="stylesheet"
      href="/css/syntax.min.dd17d6ee5bba73cc3f814469aae150232f0fc13a2038e79772f4d25565b5a23c.css"
      integrity="sha256-3RfW7lu6c8w/gURpquFQIy8PwTogOOeXcvTSVWW1ojw="
      crossorigin="anonymous"
      media="screen"
    />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://kristhecodingunicorn.com/post/k8s_hadolint/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  

  <script
  async
  defer
  src="https://umami-guidemetothemoon.vercel.app/18352c56e4b049f69a24fbae0ca62b4f.js"
  data-website-id="9dd30a0e-3918-4513-b61d-4dd81e20ed4b"
></script>



  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kristhecodingunicorn.com/images/site-feature-image.png"/>

<meta name="twitter:title" content="Applying Dockerfile best practices with Hadolint"/>
<meta name="twitter:description" content="In this blog post we&#39;ll look into how we can ensure that Dockerfiles we create are following best practices with Hadolint tool."/>



  
  <meta property="og:title" content="Applying Dockerfile best practices with Hadolint" />
<meta property="og:description" content="In this blog post we&#39;ll look into how we can ensure that Dockerfiles we create are following best practices with Hadolint tool." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kristhecodingunicorn.com/post/k8s_hadolint/" /><meta property="og:image" content="https://kristhecodingunicorn.com/images/site-feature-image.png"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-11-13T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-11-13T00:00:00+00:00" /><meta property="og:site_name" content="Kris - The Coding Unicorn" />



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "post",
        "name": "Applying Dockerfile best practices with Hadolint",
        "headline": "Applying Dockerfile best practices with Hadolint",
        "alternativeHeadline": "",
        "description": "
      In this blog post we\u0027ll look into how we can ensure that Dockerfiles we create are following best practices with Hadolint tool.


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/kristhecodingunicorn.com\/post\/k8s_hadolint\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "creator" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "copyrightYear" : "2022",
        "dateCreated": "2022-11-13T00:00:00.00Z",
        "datePublished": "2022-11-13T00:00:00.00Z",
        "dateModified": "2022-11-13T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Kristina D.",
            "url": "https://kristhecodingunicorn.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/kristhecodingunicorn.com\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://kristhecodingunicorn.com/images/site-feature-image.png"


      
      ]

    ,
        "url" : "https:\/\/kristhecodingunicorn.com\/post\/k8s_hadolint\/",
        "wordCount" : "1775",
        "genre" : [ ],
        "keywords" : [ 
      
      "kubernetes"

    
      
        ,

      
      "aks"

    
      
        ,

      
      "k8s"

    
      
        ,

      
      "azure"

    ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/profile.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Kris - The Coding Unicorn</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Welcome to my tech corner! ü§ó <br />I preach about all things cloud native, green tech and cats üêà <br />Check "Blog" for new posts and "About" for my community involvement ü¶Ñ</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://www.linkedin.com/in/krisde"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://github.com/guidemetothemoon"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://twitter.com/kristhecodingu1"
            target="_blank"
            rel="noopener me"
            aria-label="Twitter"
            title="Twitter"
          >
            <i class="fab fa-twitter fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://sessionize.com/kristina-devochko"
            target="_blank"
            rel="noopener me"
            aria-label="Sessionize"
            title="Sessionize"
          >
            <i class="fas fa-bullhorn fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Fkristhecodingunicorn.com%2Findex.xml"
            target="_blank"
            rel="noopener me"
            aria-label="rss"
            title="rss"
          >
            <i class="fas fa-rss fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
    <ul class="sidebar__list">
      <li class="sidebar__list-item">
        <a role="button" href="https://www.buymeacoffee.com/kristhecodingu1" target="_blank"><img style="max-width:100%;height:auto" src="/images/bmc_button.png" alt="Buy A Meal For Stray Cat"></a>
      </li>
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        2023 - Powered by Hugo
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/post/"
              
              title=""
              >Blog</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/techtips/"
              
              title=""
              >Tech Tips</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/public/"
              
              title=""
              >Public Talks and Publications</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            <a
              
              href="/contact/"
              
              title=""
              >Contact</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>Applying Dockerfile Best Practices With Hadolint</h1>
      
        <ul class="post__meta">
          <li class="post__meta-item">
            <em class="fas fa-calendar-day post__meta-icon"></em>
            <span class="post__meta-text"
              >
                
                  13/11/2022
                

              
            </span>
          </li>
          <li class="post__meta-item">
            <em class="fas fa-stopwatch post__meta-icon"></em>
            <span class="post__meta-text">9-minute read</span>
          </li>
        </ul>
      <p><img src="../../images/k8s_hadolint/k8s_hadolint_banner.png" alt="Article banner for applying Dockerfile best practices with Hadolint"></p>
<div class="toc">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#hadolint---introduction-and-benefits">Hadolint - Introduction and benefits</a></li>
    <li><a href="#installation-and-execution-options-for-hadolint">Installation and execution options for Hadolint</a>
      <ul>
        <li><a href="#azure-devops">Azure DevOps</a></li>
        <li><a href="#github-actions">GitHub Actions</a></li>
        <li><a href="#local-development-vscode-extension">Local development (VSCode Extension)</a></li>
      </ul>
    </li>
    <li><a href="#additional-resources">Additional resources</a></li>
  </ul>
</nav>
</div>
<p>In this blog post I would like to take a look at how we can ensure that Dockerfiles we create are of high quality and are following best practices in the industry. Tools like Hadolint make it very easy for us to do that and can automate the verification process.</p>
<p>If you&rsquo;re working with containerized applications or are planning on containerizing an application you will most likely be working with a Dockerfile. Dockerfile is a variation of a text file (without a file extension though) where you define a set of instructions for assembling, configuring and starting up your application container image. Those instructions are then compiled during the build process (for example, with <code>docker build</code> command) and are packaged into an artifact, known as a container image, which may then be pushed to a container registry like Docker Hub or Azure Container Registry.</p>
<p>You can read more about it in official Docker documentation: <a href="https://docs.docker.com/engine/reference/builder">Dockerfile reference</a></p>
<h2 id="hadolint---introduction-and-benefits">Hadolint - Introduction and benefits</h2>
<p>Code linters help a lot with ensuring that the code you&rsquo;re writing is following quality guidelines and a set of established best practices, both in the industry and in your organization (which you can define through custom rules if the linting tool supports it).</p>
<p>Dockerfile is not an exception. Tools like Hadolint can help you keep Dockerfile instructions clean, avoid unnecessary instructions and optimize existing ones. What I also like a lot about Hadolint is that it integrates with ShellCheck which is an open source tool that is used for static analysis of shell scripts, for example those that are written in Bash. This integration allows Hadolint to not only flag issues in the Dockerfile instructions, but it will also flag issues with shell commands that are a part of the same Dockerfile (for instance, commands that are executed as part of the <code>RUN</code> instruction).</p>
<p>Now let&rsquo;s see how Hadolint can be installed and used for Dockerfile linting.</p>
<h2 id="installation-and-execution-options-for-hadolint">Installation and execution options for Hadolint</h2>
<p>Hadolint can be installed from pre-built binaries, source code or as a Docker image. You can find more information about it in the official documentation which is linked in the <strong>&ldquo;Additional resources&rdquo;</strong> section below. If you&rsquo;re using Visual Studio Code then you can also install Hadolint as a VSCode extension for integrating lint checks as part of local development routines. When it comes to CI/CD integration I could only find officially provided support for GitHub Actions: <a href="https://github.com/hadolint/hadolint-action">Hadolint Action</a>. When it comes to Azure DevOps for example, there is no official extension for the same but I will show you how it can be implemented shortly.</p>
<p>A few configuration options that are worth mentioning:</p>
<ul>
<li><code>--config [path_to_config_yaml]</code> can be used to provide a path to a configuration file that can be used by Hadolint for customizing it&rsquo;s execution to your needs. Configuration can also be provided as a command input but I prefer using a configuration file to keep it cleaner and better structured. All of the below properties can also be defined in the configuration file.</li>
<li><code>--failure-threshold [rule_severity]</code> can be used to define which discoveries should make Hadolint fail. For example, if you want it to fail in case any warnings and/or errors are detected, you can define it like <code>--failure-threshold warning</code> - in this case, all rules with severity warning or higher will cause Hadolint to fail.</li>
<li><code>--trusted-registry [registry]</code> is a very nice configuration option as well - it can be used to define which container registries are allowed to be used as part of the <code>FROM</code> instruction of the Dockerfile. This is a good policy from the security perspective because it allows you to whitelist only a set of trusted container registries and prohibit importing base images from any other container registries. So if you would only whitelist your private Azure Container Registry you could define it like <code>--trusted-registry kristhecodingunicorn.azurecr.io</code>.</li>
<li><code>--format</code> can be used to specify which format you would like Hadolint to produce result report in. For Azure DevOps it may be worth considering using <code>--format sarif</code>, because then you could integrate the output of Hadolint to a dedicated tab in the build pipeline overview - I will show how it looks like in a jiffüòä</li>
</ul>
<p>Now, let&rsquo;s see Hadolint in action!</p>
<h3 id="azure-devops">Azure DevOps</h3>
<p>As I mentioned above, there is no official extension for Hadolint in Azure DevOps but you can easily create a build task yourself for the same. You can either pull a Hadolint container image or use pre-built binaries. Personally I prefer to limit the amount of external images to be pulled as part of CI/CD pipeline, therefore I will show how you could use the pre-built binaries to run Hadolint. If you would like to use Hadoling Docker image it&rsquo;s also possible to store third-party container images in your private container registry for additional security.</p>
<p>In the example below I have created two build tasks: one that downloads and executes Hadolint and outputs the results in a SARIF format. The second task publishes the report as a build artifact so that it can be consumed by the SARIF Azure DevOps extension and displayed in the Scans tab of my build execution overview:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># azure-pipeline.yaml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">job</span><span class="p">:</span><span class="w"> </span><span class="l">Build</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">steps</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l">Bash@3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="l">Lint Dockerfile with Hadolint for best practice compliance</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">targetType</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;inline&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="l">|        </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">echo &#39;Downloading Hadolint to lint Dockerfile...&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">wget https://github.com/hadolint/hadolint/releases/download/v2.12.0/hadolint-Linux-x86_64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">chmod +x hadolint-Linux-x86_64</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">mv hadolint-Linux-x86_64 hadolint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                  
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">echo &#39;Start Dockerfile lint...&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="l">./hadolint ./docker/Dockerfile -f sarif | jq &gt; hadolint-scan.sarif</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l">PublishBuildArtifacts@1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">displayName: &#39;Publish Artifact</span><span class="p">:</span><span class="w"> </span><span class="l">Hadolint Dockerfile Scan&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">inputs</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">pathToPublish</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;hadolint-scan.sarif&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">artifactName</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;CodeAnalysisLogs&#39;</span><span class="w">
</span></span></span></code></pre></div><p><img src="../../images/k8s_hadolint/k8s_hadolint_ado_sarif_output.png" alt="Screenshot of Hadolint tool output"></p>
<p>Below you can see another example of Hadolint output without SARIF extension, where all the findings are logged as part of the build task output. In this example Hadolint is configured to fail when warnings or more critical findings are detected. Command above can be modified like this (Dockerfile folder path is also updated to correlate with what&rsquo;s shown on the screenshot):</p>
<p><code>./hadolint ./wiki/Dockerfile --failure-threshold warning</code></p>
<p><img src="../../images/k8s_hadolint/k8s_hadolint_output.png" alt="Screenshot of Hadolint tool output"></p>
<p>If there are issues that are not applicable to your specific use case you can suppress them by specifying them in the configuration file or directly in the command line. You can also specify any other relevant configuration in the same file to keep the execution command short and sweet. For example, below I have created a <code>hadolint.yaml</code> configuration file where I define both at what severity levels Hadolint must fail, which findings to ignore and which container registries are allowed to be used as part of a Dockerfile.</p>
<blockquote>
<p>When you&rsquo;re suppressing an issue, be it the one detected by Hadolint or another tool, it&rsquo;s always a good idea to add a comment explaining the reasoning behind suppression. It&rsquo;s helpful both for others accessing the file and for general accountability.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># hadolint.yaml: </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">failure-threshold</span><span class="p">:</span><span class="w"> </span><span class="l">error</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">ignored</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">DL3009</span><span class="w"> </span><span class="c"># false positive, apt-get lists are deleted on line 13</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>- <span class="l">DL4006</span><span class="w"> </span><span class="c"># false positive, -o pipefail is set via explicit RUN statements on line 12 and 31</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">trustedRegistries</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;kristhecodingunicorn.acr.io&#34;</span><span class="w"> </span><span class="c"># you can also use the wildcard pattern here, f.ex. &#34;*.acr.io&#34; to whitelist all Azure Container Registry repositories</span><span class="w">
</span></span></span></code></pre></div><p>Hadolint command can once again be modified to incorporate configuration from the file:</p>
<p><code>./hadolint ./docker/Dockerfile --config ./hadolint.yaml</code></p>
<h3 id="github-actions">GitHub Actions</h3>
<p>There&rsquo;s a GitHub Action provided by the Hadolint project maintainers so we can use it directly in our GitHub Workflow like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># myapp-gha.yml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Lint Dockerfile with Hadolint</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l">hadolint/hadolint-action@v3.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">with</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">./docker/Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">failure-threshold</span><span class="p">:</span><span class="w"> </span><span class="l">error</span><span class="w">
</span></span></span></code></pre></div><p>Please note that in case of Hadolint GitHub Action linting results are not being logged to the task output but are logged to an environment variable which is called <code>HADOLINT_RESULTS</code>. You can print it out with a subsequent GitHub Action, for example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># myapp-gha.yml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Print Hadolint lint results</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l">echo &#39;HADOLINT LINT RESULTS =&gt; ${{ env.HADOLINT_RESULTS }}&#39;</span><span class="w">
</span></span></span></code></pre></div><p>You can also save Hadolint output to a separate file to consume it for display or upload at a later point by providing <code>output-file: &lt;file_path&gt;</code> and <code>format: &lt;output_format&gt;</code> parameters to <code>with</code> section of the GitHub Action. You can also integrate PR comments based on the execution results - you can read more about it on the Hadolint Action page on GitHub marketplace: <a href="https://github.com/marketplace/actions/hadolint-action">Hadolint Action</a></p>
<h3 id="local-development-vscode-extension">Local development (VSCode Extension)</h3>
<p>It is a good idea to integrate some tools as part of the local development routines in order to detect potential issues and quality improvements early in the development lifecycle. Fortunately Hadolint can be installed as a VSCode extension. You can search for it directly in the Extensions tab of Visual Studio Code or check out it&rsquo;s page on VSCode marketplace: <a href="https://marketplace.visualstudio.com/items?itemName=exiasr.hadolint">hadolint</a>.</p>
<blockquote>
<p>If you&rsquo;re getting an error message after installation that says that hadolint executable can&rsquo;t be found it may be that you have saved it to an unusual folder. You can verify and update that by going to <code>Extension Settings</code> of Hadolint extension in VSCode and updating <code>Hadolint: Hadolint Path</code> field either in User or Workspace tab, or both.</p>
</blockquote>
<p>Once it&rsquo;s installed and you open a Dockerfile in VSCode you will get information about detected issues in the <strong>&ldquo;Problems&rdquo;</strong> tab of your VSCode workspace.
Let&rsquo;s take a look at a simple example.</p>
<p>Here I have a simple Dockerfile:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">FROM mcr.microsoft.com/dotnet/aspnet:6.0-jammy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">COPY CatEncyclopedia/src App/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">WORKDIR /App</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">ENTRYPOINT [&#34;dotnet&#34;, &#34;CatEncyclopedia.dll&#34;]</span><span class="w">
</span></span></span></code></pre></div><p>Once I open it in VSCode I can see that Hadolint gets into action and lets me know that there&rsquo;s something I need to improve in my file:</p>
<p><img src="../../images/k8s_hadolint/k8s_hadolint_vscode_output1.png" alt="Screenshot of Hadolint VSCode extension output when an issue is detected"></p>
<p>You can also see from the screenshot above that detected issues are highlighted directly in the Dockerfile so that you can hover over them to read the same information that you can see in the Problems tab.</p>
<p>It seems like I have misplaced some Docker instructions. Since I am actually setting a <code>WORKDIR</code>, let&rsquo;s move this instruction so that it happens before the <code>COPY</code> instruction.
Now our Dockerfile will look like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">FROM mcr.microsoft.com/dotnet/aspnet:6.0-jammy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">WORKDIR /App</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">COPY CatEncyclopedia/src App/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">ENTRYPOINT [&#34;dotnet&#34;, &#34;CatEncyclopedia.dll&#34;]</span><span class="w">
</span></span></span></code></pre></div><p>And once we save the changes, we can see that the warning disappears from the Problems tab:</p>
<p><img src="../../images/k8s_hadolint/k8s_hadolint_vscode_output2.png" alt="Screenshot of Hadolint tool output"></p>
<p>Great work everyone, our Dockerfile has become a notch better!üò∫</p>
<h2 id="additional-resources">Additional resources</h2>
<ul>
<li>Hadolint VSCode extension: <a href="https://marketplace.visualstudio.com/items?itemName=exiasr.hadolint">hadolint</a></li>
<li>Hadolint source code on GitHub: <a href="https://github.com/hadolint/hadolint">Haskell Dockerfile Linter</a></li>
<li>ShellCheck documentation: <a href="https://www.shellcheck.net/wiki/Home">ShellCheck Wiki</a></li>
<li>Docker provides some of the best practices for writing Dockerfiles in their official documentation: <a href="https://docs.docker.com/develop/develop-images/dockerfile_best-practices">Best practices for writing Dockerfiles</a></li>
<li>Azure DevOps SARIF extension: <a href="https://marketplace.visualstudio.com/items?itemName=sariftools.scans">SARIF SAST Scans Tab</a></li>
</ul>
<p>That's it from me this time, thanks for checking in!</p>
<p>If this article was helpful, I'd love to hear about it! You can reach out to me on LinkedIn, Twitter, GitHub or by using the contact form on this page üò∫</p>
<p>Stay secure, stay safe.</p>
<p>Till we connect again!üòª</p>
</div>
    <div class="post__footer">
      

      
        <span><a class="tag" href="/tags/kubernetes/">kubernetes</a><a class="tag" href="/tags/aks/">aks</a><a class="tag" href="/tags/k8s/">k8s</a><a class="tag" href="/tags/azure/">azure</a></span>


      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        2023 - Powered by Hugo
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></body>
</html>
