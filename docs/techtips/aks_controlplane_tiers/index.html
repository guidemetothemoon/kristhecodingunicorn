<!DOCTYPE html>
<html
  dir="ltr"
  lang="en"
  data-theme="dark"
  
    class="html theme--dark"
  
><head>
  <title>
    Kris - The Coding Unicorn
        |
        AKS control plane tiers - what, when and how?
      

    

  </title>

  
  <meta charset="utf-8" /><meta name="generator" content="Hugo 0.115.0"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Kris - The Coding Unicorn" />
  <meta
    name="description"
    content="In this tech tip we look at AKS control plane tiers, when to use which tier and how to define it in code."
  />
  
    <meta name="google-site-verification" content="OQXmc6vSYyn6I-aGZoI6GH2M6CdM4NjmwulDqvvNCQA" />
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.772eefee9824c26da5d3828c2507ea318c8e7a37b0b1d18cd4f224edc2755fea.css"
      integrity="sha256-dy7v7pgkwm2l04KMJQfqMYyOejewsdGM1PIk7cJ1X&#43;o="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
    
    
    <link
      rel="stylesheet"
      href="/css/syntax.min.dd17d6ee5bba73cc3f814469aae150232f0fc13a2038e79772f4d25565b5a23c.css"
      integrity="sha256-3RfW7lu6c8w/gURpquFQIy8PwTogOOeXcvTSVWW1ojw="
      crossorigin="anonymous"
      media="screen"
    />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="https://kristhecodingunicorn.com/techtips/aks_controlplane_tiers/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  

  <script
  async
  defer
  src="https://umami-guidemetothemoon.vercel.app/18352c56e4b049f69a24fbae0ca62b4f.js"
  data-website-id="9dd30a0e-3918-4513-b61d-4dd81e20ed4b"
></script>



  
  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kristhecodingunicorn.com/images/site-feature-image.png"/>

<meta name="twitter:title" content="AKS control plane tiers - what, when and how?"/>
<meta name="twitter:description" content="In this tech tip we look at AKS control plane tiers, when to use which tier and how to define it in code."/>



  
  <meta property="og:title" content="AKS control plane tiers - what, when and how?" />
<meta property="og:description" content="In this tech tip we look at AKS control plane tiers, when to use which tier and how to define it in code." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kristhecodingunicorn.com/techtips/aks_controlplane_tiers/" /><meta property="og:image" content="https://kristhecodingunicorn.com/images/site-feature-image.png"/><meta property="article:section" content="techtips" />
<meta property="article:published_time" content="2023-01-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-01-24T00:00:00+00:00" /><meta property="og:site_name" content="Kris - The Coding Unicorn" />



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "techtips",
        "name": "AKS control plane tiers - what, when and how?",
        "headline": "AKS control plane tiers - what, when and how?",
        "alternativeHeadline": "",
        "description": "
      In this tech tip we look at AKS control plane tiers, when to use which tier and how to define it in code.


    ",
        "inLanguage": "en",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/kristhecodingunicorn.com\/techtips\/aks_controlplane_tiers\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "creator" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Kristina D."
        },
        "copyrightYear" : "2023",
        "dateCreated": "2023-01-24T00:00:00.00Z",
        "datePublished": "2023-01-24T00:00:00.00Z",
        "dateModified": "2023-01-24T00:00:00.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Kristina D.",
            "url": "https://kristhecodingunicorn.com",
            "logo": {
                "@type": "ImageObject",
                "url": "https:\/\/kristhecodingunicorn.com\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
        
        "https://kristhecodingunicorn.com/images/site-feature-image.png"


      
      ]

    ,
        "url" : "https:\/\/kristhecodingunicorn.com\/techtips\/aks_controlplane_tiers\/",
        "wordCount" : "762",
        "genre" : [ ],
        "keywords" : [ 
      
      "techtips"

    
      
        ,

      
      "azure"

    
      
        ,

      
      "aks"

    
      
        ,

      
      "kubernetes"

    
      
        ,

      
      "devops"

    
      
        ,

      
      "gitops"

    ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/profile.webp"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">Kris - The Coding Unicorn</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Welcome to my tech corner! ü§ó <br />I preach about all things cloud native, green tech and cats üêà <br />Check "Blog" for new posts and "About" for my community involvement ü¶Ñ</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://linkfree.io/guidemetothemoon"
            target="_blank"
            rel="noopener me"
            aria-label="Let&#39;s connect!"
            title="Let&#39;s connect!"
          >
            <i class="fas fa-cat fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://www.buymeacoffee.com/kristhecodingu1"
            target="_blank"
            rel="noopener me"
            aria-label="Help me buy supplies for homeless animals &lt;3"
            title="Help me buy supplies for homeless animals &lt;3"
          >
            <i class="fas fa-hand-holding-heart fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://feedly.com/i/subscription/feed%2Fhttps%3A%2F%2Fkristhecodingunicorn.com%2Findex.xml"
            target="_blank"
            rel="noopener me"
            aria-label="RSS feed"
            title="RSS feed"
          >
            <i class="fas fa-rss fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div id="wcb"  
        
        class="carbonbadge wcb-d"
        
    >
    </div>
    <script src="https://unpkg.com/website-carbon-badges@1.1.3/b.min.js" defer></script>
  <footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        2023 - Powered by Hugo
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >Home</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/post/"
              
              title=""
              >Blog</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/techtips/"
              
              title=""
              >Tech Tips</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/public/"
              
              title=""
              >Public Talks and Publications</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/about/"
              
              title=""
              >About</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/contact/"
              
              title=""
              >Contact</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>AKS Control Plane Tiers - What, When and How?</h1>
      <p><img src="../../images/tech_tips/techtip_18.png" alt="Article banner for AKS control plane tiers"></p>
<div class="toc">
  <nav id="TableOfContents"></nav>
</div>
<p>Recently a new property became available in Azure Portal when creating a new Azure Kubernetes Service instance:</p>
<p><img src="../../images/tech_tips/aks_tiers_portal.png" alt="Screenshot of AKS control plane tiers in Azure Portal"></p>
<p>Have you seen it and do you know what it actually is? Wait, does AKS have pricing tiers?! I thought that the only price we need to pay was based on the chosen VM SKU for AKS Nodes&hellip;.right?ü§®</p>
<p>Well, the answer is yes and no.üò∫ By default AKS is a free service and you only pay for the virtual machines you choose for your Nodes, plus associated storage and networking resources. There are nevertheless some additional billed capabilities that can be enabled, like <strong>Uptime SLA</strong>, which is now more streamlined with visibility in Azure Portal.</p>
<p>What you can see on the screenshot above is related to enablement of an AKS capability called <code>Uptime SLA</code>, and it is mainly related to making control plane of the AKS cluster highly available. General best practice for Kubernetes control plane availability is to have multiple replicas of a control plane that are running on at least 3 nodes spread across failure zones, either with stacked <code>etcd</code> (a replica of <code>etcd</code> deployed per node) or external <code>etcd</code> (<code>etcd</code> replicas are deployed separately, on dedicated hosts, which are also known as <code>external etcd cluster</code>) topology.</p>
<p>The thing is that, when it comes to Managed Kubernetes Service like AKS, cloud provider is responsible for managing control plane, and us as consumers may not get enough information in order to understand what has been done in terms of control plane availability. In case of AKS Microsoft doesn&rsquo;t share implementation details for the control plane architecture, where one of the reasons being that it&rsquo;s subject to frequent changes. What we know though is that without Uptime SLA there are fewer replicas and resources available for the control plane to scale, therefore creating AKS clusters without Uptime SLA is not recommended for production workloads.</p>
<blockquote>
<p><em><strong>Update February 2023:</strong></em> New documentation from Microsoft was released that provides some more details regarding AKS pricing tiers. For instance, if you have more than 10 nodes in your AKS cluster, it&rsquo;s recommended to use Standard tier, even though Free tier can support up to 1000 nodes. You can read more about it here: <a href="https://learn.microsoft.com/en-us/azure/aks/free-standard-pricing-tiers">Free and Standard pricing tiers for Azure Kubernetes Service (AKS) cluster management</a></p>
</blockquote>
<p>With Uptime SLA, 99.95% availability is guaranteed for Kubernetes API server endpoint for AKS clusters with availability zones and 99.9% for AKS clusters without availability zones. For production workloads you should also use availability zones in order to ensure that your clusters will keep running in case of a region failure for example.</p>
<p>You can enable/disable Uptime SLA both for new and existing AKS clusters without downtime. We have seen above how you can enable it for a new AKS cluster in the Azure Portal. You can enable it for existing AKS cluster through Azure Portal, from the &ldquo;Cluster configuration&rdquo; section:</p>
<p><img src="../../images/tech_tips/aks_sla_existing.png" alt="Screenshot of how to enable Uptime SLA for existing AKS cluster from Cluster configuration section in Azure Portal"></p>
<p>A few programmatical options you can do the same with:</p>
<blockquote>
<p><em><strong>Update February 2023:</strong></em> Breaking changes are being introduced to AKS pricing tiers API which means that, with <strong>Azure CLI version 2.46.0 or newer</strong> and <strong>API version 2023-01-01 or newer</strong> you will need to update AKS SKU tier and name properties to following values (also mentioned in examples below): <img src="../../images/tech_tips/aks_sla_api_changes.png" alt="Screenshot of changes to AKS pricing tiers API"></p>
</blockquote>
<p><strong>Azure CLI</strong></p>
<p>You can use <code>--uptime-sla</code> (or <code>--tier standard</code> for Azure CLI v2.46.0 or newer) argument to enable Uptime SLA on new and existing AKS clusters, and <code>--no-uptime-sla</code> (or <code>--tier free</code> for Azure CLI v2.46.0 or newer) to disable it.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Azure CLI prior to v2.46.0</span>
</span></span><span class="line"><span class="cl">az aks create --name chamber-of-secrets --resource-group hogwarts-rg --uptime-sla
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">az aks update --resource-group hogwarts-rg --name chamber-of-secrets --uptime-sla
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Azure CLI v2.46.0 or newer</span>
</span></span><span class="line"><span class="cl">az aks create --name chamber-of-secrets --resource-group hogwarts-rg --tier standard
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">az aks update --resource-group hogwarts-rg --name chamber-of-secrets --tier standard
</span></span></code></pre></div><p><strong>Terraform</strong></p>
<p>You can use <code>sku_tier</code> attribute of <code>azurerm</code> provider to enable Uptime SLA by setting it to <code>Paid</code> (<code>Standard</code> for 2023-01-01 API version or newer). Default value is <code>Free</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">resource <span class="s2">&#34;azurerm_kubernetes_cluster&#34;</span> <span class="s2">&#34;aks&#34;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">name</span>                            <span class="o">=</span> <span class="s2">&#34;chamber-of-secrets&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">location</span>                         <span class="o">=</span> azurerm_resource_group.aks.location
</span></span><span class="line"><span class="cl">  <span class="nv">resource_group_name</span> <span class="o">=</span> <span class="s2">&#34;hogwarts-rg&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">sku_tier</span>                         <span class="o">=</span> <span class="s2">&#34;Paid&#34;</span> <span class="c1"># &#34;Standard&#34; for 2023-01-01 API version or newer</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># REST OF THE CODE IS OMITTED</span>
</span></span></code></pre></div><p><strong>Bicep</strong></p>
<p><code>sku.tier</code> setting can be used to enable Uptime SLA.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">resource aks &#39;Microsoft.ContainerService/managedClusters@2022-05-02-preview&#39; = {</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;chamber-of-secrets&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">location</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;norwayeast&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">sku</span><span class="p">:</span><span class="w"> </span>{<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Basic&#39;</span><span class="w"> </span><span class="l">// &#39;Base&#39; for 2023-01-01 API version or newer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">tier</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Paid&#39;</span><span class="w">     </span><span class="l">// &#39;Standard&#39; for 2023-01-01 API version or newer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span>}<span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">// REST OF THE CODE IS OMITTED</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span>}<span class="w">
</span></span></span></code></pre></div><p>You can read more about AKS Uptime SLA here: <a href="https://learn.microsoft.com/en-us/azure/aks/uptime-sla">Azure Kubernetes Service (AKS) Uptime SLA</a></p>
<p>That's it for now - Thanks for reading and till next tech tip üòº</p>
</div>
    <div class="post__footer">
      

      
        <span><a class="tag" href="/tags/techtips/">techtips</a><a class="tag" href="/tags/azure/">azure</a><a class="tag" href="/tags/aks/">aks</a><a class="tag" href="/tags/kubernetes/">kubernetes</a><a class="tag" href="/tags/devops/">devops</a><a class="tag" href="/tags/gitops/">gitops</a></span>


      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        2023 - Powered by Hugo
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></body>
</html>
